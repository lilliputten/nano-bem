{"version":3,"sources":["../src/MicroEvents.js"],"names":["inherit","require","MicroEvents","_handlers","_add","id","handlerData","push","on","cb","ctx","once","off","cbs","Array","isArray","found","reduce","item","n","splice","un","apply","arguments","emit","length","args","from","slice","i","cbMethod","bind"],"mappings":";;;;;;;AAAA;;;;;;AAOA,IAAMA,OAAO,GAAGC,OAAO,CAAC,SAAD,CAAvB;;AAEA,IAAMC,WAAW,GAAGF,OAAO;AAAE;AAAoC;AAE/D;;;AAGAG,EAAAA,SAAS,EAAE,EALoD;;AAO/D;;;;AAIAC,EAAAA,IAAI,EAAE,cAASC,EAAT,EAAaC,WAAb,EAA0B;AAC9B,QAAIA,WAAJ,EAAiB;AACf,OAAC,KAAKH,SAAL,CAAeE,EAAf,MAAuB,KAAKF,SAAL,CAAeE,EAAf,IAAqB,EAA5C,CAAD,EAAkDE,IAAlD,CAAuDD,WAAvD;AACD;AACF,GAf8D;;AAiB/D;;;;;;AAMAE,EAAAA,EAAE,EAAE,YAASH,EAAT,EAAaI,EAAb,EAAiBC,GAAjB,EAAsB;AACxB,QAAI,OAAOD,EAAP,KAAc,UAAlB,EAA8B;AAC5B,WAAKL,IAAL,CAAUC,EAAV,EAAc;AAAEI,QAAAA,EAAE,EAAFA,EAAF;AAAMC,QAAAA,GAAG,EAAHA;AAAN,OAAd;AACD;;AACD,WAAO,IAAP;AACD,GA5B8D;;AA8B/D;;;;;;AAMAC,EAAAA,IAAI,EAAE,cAASN,EAAT,EAAaI,EAAb,EAAiBC,GAAjB,EAAsB;AAC1B,QAAI,OAAOD,EAAP,KAAc,UAAlB,EAA8B;AAC5B,WAAKL,IAAL,CAAUC,EAAV,EAAc;AAAEI,QAAAA,EAAE,EAAFA,EAAF;AAAMC,QAAAA,GAAG,EAAHA,GAAN;AAAWC,QAAAA,IAAI,EAAE;AAAjB,OAAd;AACD;;AACD,WAAO,IAAP;AACD,GAzC8D;;AA2C/D;;;;;;AAMAC,EAAAA,GAAG,EAAE,aAASP,EAAT,EAAaI,EAAb,EAAiBC,GAAjB,EAAsB;AACzB,QAAMG,GAAG,GAAG,KAAKV,SAAL,CAAeE,EAAf,CAAZ;;AACA,QAAI,OAAOI,EAAP,KAAc,UAAd,IAA4BK,KAAK,CAACC,OAAN,CAAcF,GAAd,CAAhC,EAAoD;AAClD;AACA,UAAMG,KAAK,GAAGH,GAAG,CAACI,MAAJ,CAAW,UAACD,KAAD,EAAQE,IAAR,EAAcC,CAAd,EAAoB;AAC3C;AACA,YAAIV,EAAE,IAAIS,IAAI,CAACT,EAAX,KAAmB,CAACC,GAAD,IAAQ,CAACQ,IAAI,CAACR,GAAf,IAAuBA,GAAG,KAAKQ,IAAI,CAACR,GAAtD,CAAJ,EAAgE;AAC9DM,UAAAA,KAAK,GAAGG,CAAR;AACD;;AACD,eAAOH,KAAP;AACD,OANa,EAMX,CAAC,CANU,CAAd,CAFkD,CASlD;;AACA,UAAIA,KAAK,KAAK,CAAC,CAAf,EAAkB;AAChBH,QAAAA,GAAG,CAACO,MAAJ,CAAWJ,KAAX,EAAkB,CAAlB;AACD;AACF;;AACD,WAAO,IAAP;AACD,GAlE8D;;AAoE/D;;AAEAK,EAAAA,EAAE,EAAE;AAAS;AAAmB;AAC9B,WAAO,KAAKT,GAAL,CAASU,KAAT,CAAe,IAAf,EAAqBC,SAArB,CAAP;AACD,GAxE8D;;AA0E/D;;;;;AAKAC,EAAAA,IAAI,EAAE,cAASnB;AAAE;AAAX,IAA4B;AAChC,QAAMQ,GAAG,GAAG,KAAKV,SAAL,CAAeE,EAAf,CAAZ;;AACA,QAAIS,KAAK,CAACC,OAAN,CAAcF,GAAd,KAAsBA,GAAG,CAACY,MAA9B,EAAsC;AACpC;AACA,UAAMC,IAAI,GAAGZ,KAAK,CAACa,IAAN,CAAWJ,SAAX,EAAsBK,KAAtB,CAA4B,CAA5B,CAAb,CAFoC,CAGpC;;AACA,WAAK,IAAIC,CAAC,GAAGhB,GAAG,CAACY,MAAJ,GAAa,CAA1B,EAA6BI,CAAC,IAAI,CAAlC,EAAqCA,CAAC,EAAtC,EAA0C;AAAA,qBACdhB,GAAG,CAACgB,CAAD,CADW;AAAA,YAChCpB,EADgC,UAChCA,EADgC;AAAA,YAC5BC,GAD4B,UAC5BA,GAD4B;AAAA,YACvBC,IADuB,UACvBA,IADuB;;AAExC,YAAI,OAAOF,EAAP,KAAc,UAAlB,EAA8B;AAC5B;AACA,cAAMqB,QAAQ,GAAIpB,GAAD,GAAQD,EAAE,CAACsB,IAAH,CAAQrB,GAAR,CAAR,GAAuBD,EAAxC,CAF4B,CAG5B;;AACAqB,UAAAA,QAAQ,CAACR,KAAT,CAAe,IAAf,EAAqBI,IAArB,EAJ4B,CAK5B;;AACA,cAAIf,IAAJ,EAAU;AACRE,YAAAA,GAAG,CAACO,MAAJ,CAAWS,CAAX,EAAc,CAAd;AACD;AACF;AACF;AACF;;AACD,WAAO,IAAP;AACD;AApG8D,CAAtC,CAA3B;eAwGe3B,W","sourcesContent":["/** @module MicroEvents\n *  @class MicroEvents\n *  @desc Minimal events manager engine\n *  @since 2019.06.06, 09:32\n *  @changed 2019.06.27, 08:27\n */\n\nconst inherit = require('inherit');\n\nconst MicroEvents = inherit( /** @lends MicroEvents.prototype */ {\n\n  /** Event handlers storage\n   * @type {Object}\n   */\n  _handlers: {},\n\n  /** Low-level add handler method\n   * @param {String} id\n   * @param {Object] handlerData\n   */\n  _add: function(id, handlerData) {\n    if (handlerData) {\n      (this._handlers[id] || (this._handlers[id] = [])).push(handlerData);\n    }\n  },\n\n  /** Add event handler\n   * @param {String} id\n   * @param {Function} cb\n   * @param {Object} [ctx]\n   * @return {Object} this\n   */\n  on: function(id, cb, ctx) {\n    if (typeof cb === 'function') {\n      this._add(id, { cb, ctx });\n    }\n    return this;\n  },\n\n  /** Add once-running event handler\n   * @param {String} id\n   * @param {Function} cb\n   * @param {Object} [ctx]\n   * @return {Object} this\n   */\n  once: function(id, cb, ctx) {\n    if (typeof cb === 'function') {\n      this._add(id, { cb, ctx, once: true });\n    }\n    return this;\n  },\n\n  /** Remove event handler\n   * @param {String} id\n   * @param {Function} cb\n   * @param {Object} [ctx]\n   * @return {Object} this\n   */\n  off: function(id, cb, ctx) {\n    const cbs = this._handlers[id];\n    if (typeof cb === 'function' && Array.isArray(cbs)) {\n      // Find last mathing handler\n      const found = cbs.reduce((found, item, n) => {\n        // Compare cb & ctx\n        if (cb == item.cb && ((!ctx && !item.ctx) || ctx === item.ctx)) {\n          found = n;\n        }\n        return found;\n      }, -1);\n      // Remove if found\n      if (found !== -1) {\n        cbs.splice(found, 1);\n      }\n    }\n    return this;\n  },\n\n  /** Synonym for `off`\n   */\n  un: function(/* id, cb, ctx */) {\n    return this.off.apply(this, arguments);\n  },\n\n  /** Emit event\n   * @param {String} id\n   * @param {*} [args]\n   * @return {Object} this\n   */\n  emit: function(id/* , ...args */) {\n    const cbs = this._handlers[id];\n    if (Array.isArray(cbs) && cbs.length) {\n      // Using arguments -> args\n      const args = Array.from(arguments).slice(1);\n      // Traverse in reversed oreder (if removing `once` handlers, all other stay intact)\n      for (let i = cbs.length - 1; i >= 0; i--) {\n        const { cb, ctx, once } = cbs[i];\n        if (typeof cb === 'function') {\n          // Bind to context if specified\n          const cbMethod = (ctx) ? cb.bind(ctx) : cb;\n          // Apply to arguments\n          cbMethod.apply(this, args);\n          // Remove if `once`\n          if (once) {\n            cbs.splice(i, 1);\n          }\n        }\n      }\n    }\n    return this;\n  },\n\n});\n\nexport default MicroEvents;\n"],"file":"MicroEvents.js"}